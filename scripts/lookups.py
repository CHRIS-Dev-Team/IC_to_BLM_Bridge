# TODO: Need to gather codes for channel islands.
# TODO: Add digitization and QC status?


county_listing = [{
    "number": "01",
    "name": "ALAMEDA",
    "trinomial_code": "ALA",
    "report_code": "AA",
    "ic": "NWIC"
}, {
    'number': '02',
    'name': 'ALPINE',
    'trinomial_code': 'ALP',
    'report_code': 'AP',
    'ic': 'CCaIC'
}, {
    'number': '03',
    'name': 'AMADOR',
    'trinomial_code': 'AMA',
    'report_code': 'AM',
    'ic': 'NCIC'
}, {
    'number': '04',
    'name': 'BUTTE',
    'trinomial_code': 'BUT',
    'report_code': 'BT',
    'ic': 'NEIC'
}, {
    'number': '05',
    'name': 'CALAVERAS',
    'trinomial_code': 'CAL',
    'report_code': 'CA',
    'ic': 'CCaIC'
}, {
    'number': '06',
    'name': 'COLUSA',
    'trinomial_code': 'COL',
    'report_code': 'CO',
    'ic': 'NWIC'
}, {
    'number': '07',
    'name': 'CONTRA COSTA',
    'trinomial_code': 'CCO',
    'report_code': 'CC',
    'ic': 'NWIC'
}, {
    'number': '08',
    'name': 'DEL NORTE',
    'trinomial_code': 'DNO',
    'report_code': 'DN',
    'ic': 'NWIC'
}, {
    'number': '09',
    'name': 'EL DORADO',
    'trinomial_code': 'ELD',
    'report_code': 'ED',
    'ic': 'NCIC'
}, {
    'number': '10',
    'name': 'FRESNO',
    'trinomial_code': 'FRE',
    'report_code': 'FR',
    'ic': 'SSJVIC'
}, {
    'number': '11',
    'name': 'GLENN',
    'trinomial_code': 'GLE',
    'report_code': 'GL',
    'ic': 'NEIC'
}, {
    'number': '12',
    'name': 'HUMBOLDT',
    'trinomial_code': 'HUM',
    'report_code': 'HU',
    'ic': 'NWIC'
}, {
    'number': '13',
    'name': 'IMPERIAL',
    'trinomial_code': 'IMP',
    'report_code': 'IM',
    'ic': 'SCIC'
}, {
    'number': '14',
    'name': 'INYO',
    'trinomial_code': 'INY',
    'report_code': 'IN',
    'ic': 'EIC'
}, {
    'number': '15',
    'name': 'KERN',
    'trinomial_code': 'KER',
    'report_code': 'KE',
    'ic': 'SSJVIC'
}, {
    'number': '16',
    'name': 'KINGS',
    'trinomial_code': 'KIN',
    'report_code': 'KI',
    'ic': 'SSJVIC'
}, {
    'number': '17',
    'name': 'LAKE',
    'trinomial_code': 'LAK',
    'report_code': 'LK',
    'ic': 'NWIC'
}, {
    'number': '18',
    'name': 'LASSEN',
    'trinomial_code': 'LAS',
    'report_code': 'LS',
    'ic': 'NEIC'
}, {
    'number': '19',
    'name': 'LOS ANGELES',
    'trinomial_code': 'LAN',
    'report_code': 'LA',
    'ic': 'SCCIC'
}, {
    'number': '20',
    'name': 'MADERA',
    'trinomial_code': 'MAD',
    'report_code': 'MA',
    'ic': 'SSJVIC'
}, {
    'number': '21',
    'name': 'MARIN',
    'trinomial_code': 'MRN',
    'report_code': 'MR',
    'ic': 'NWIC'
}, {
    'number': '22',
    'name': 'MARIPOSA',
    'trinomial_code': 'MRP',
    'report_code': 'MP',
    'ic': 'CCaIC'
}, {
    'number': '23',
    'name': 'MENDOCINO',
    'trinomial_code': 'MEN',
    'report_code': 'MD',
    'ic': 'NWIC'
}, {
    'number': '24',
    'name': 'MERCED',
    'trinomial_code': 'MER',
    'report_code': 'ME',
    'ic': 'CCaIC'
}, {
    'number': '25',
    'name': 'MODOC',
    'trinomial_code': 'MOD',
    'report_code': 'MO',
    'ic': 'NEIC'
}, {
    'number': '26',
    'name': 'MONO',
    'trinomial_code': 'MNO',
    'report_code': 'MN',
    'ic': 'EIC'
}, {
    'number': '27',
    'name': 'MONTEREY',
    'trinomial_code': 'MNT',
    'report_code': 'MT',
    'ic': 'NWIC'
}, {
    'number': '28',
    'name': 'NAPA',
    'trinomial_code': 'NAP',
    'report_code': 'NP',
    'ic': 'NWIC'
}, {
    'number': '29',
    'name': 'NEVADA',
    'trinomial_code': 'NEV',
    'report_code': 'NE',
    'ic': 'NCIC'
}, {
    'number': '30',
    'name': 'ORANGE',
    'trinomial_code': 'ORA',
    'report_code': 'OR',
    'ic': 'SCCIC'
}, {
    'number': '31',
    'name': 'PLACER',
    'trinomial_code': 'PLA',
    'report_code': 'PL',
    'ic': 'NCIC'
}, {
    'number': '32',
    'name': 'PLUMAS',
    'trinomial_code': 'PLU',
    'report_code': 'PU',
    'ic': 'NEIC'
}, {
    'number': '33',
    'name': 'RIVERSIDE',
    'trinomial_code': 'RIV',
    'report_code': 'RI',
    'ic': 'EIC'
}, {
    'number': '34',
    'name': 'SACRAMENTO',
    'trinomial_code': 'SAC',
    'report_code': 'SA',
    'ic': 'NCIC'
}, {
    'number': '35',
    'name': 'SAN BENITO',
    'trinomial_code': 'SBN',
    'report_code': 'SN',
    'ic': 'NWIC'
}, {
    'number': '36',
    'name': 'SAN BERNARDINO',
    'trinomial_code': 'SBR',
    'report_code': 'SB',
    'ic': 'SCCIC'
}, {
    'number': '37',
    'name': 'SAN DIEGO',
    'trinomial_code': 'SDI',
    'report_code': 'SD',
    'ic': 'SCIC'
}, {
    'number': '38',
    'name': 'SAN FRANSCISCO',
    'trinomial_code': 'SFR',
    'report_code': 'SF',
    'ic': 'NWIC'
}, {
    'number': '39',
    'name': 'SAN JOAQUIN',
    'trinomial_code': 'SJO',
    'report_code': 'SJ',
    'ic': 'CCaIC'
}, {
    'number': '40',
    'name': 'SAN LUIS OBISPO',
    'trinomial_code': 'SLO',
    'report_code': 'SL',
    'ic': 'CCoIC'
}, {
    'number': '41',
    'name': 'SAN MATEO',
    'trinomial_code': 'SMA',
    'report_code': 'SM',
    'ic': 'NWIC'
}, {
    'number': '42',
    'name': 'SANTA BARBARA',
    'trinomial_code': 'SBA',
    'report_code': 'SR',
    'ic': 'CCoIC'
}, {
    'number': '43',
    'name': 'SANTA CLARA',
    'trinomial_code': 'SCL',
    'report_code': 'SC',
    'ic': 'NWIC'
}, {
    'number': '44',
    'name': 'SANTA CRUZ',
    'trinomial_code': 'SCR',
    'report_code': 'SZ',
    'ic': 'NWIC'
}, {
    'number': '45',
    'name': 'SHASTA',
    'trinomial_code': 'SHA',
    'report_code': 'SH',
    'ic': 'NEIC'
}, {
    'number': '46',
    'name': 'SIERRA',
    'trinomial_code': 'SIE',
    'report_code': 'SE',
    'ic': 'NEIC'
}, {
    'number': '47',
    'name': 'SISKIYOU',
    'trinomial_code': 'SIS',
    'report_code': 'SI',
    'ic': 'NEIC'
}, {
    'number': '48',
    'name': 'SOLANO',
    'trinomial_code': 'SOL',
    'report_code': 'SO',
    'ic': 'NWIC'
}, {
    'number': '49',
    'name': 'SONOMA',
    'trinomial_code': 'SON',
    'report_code': 'SX',
    'ic': 'NWIC'
}, {
    'number': '50',
    'name': 'STANISLAUS',
    'trinomial_code': 'STA',
    'report_code': 'ST',
    'ic': 'CCaIC'
}, {
    'number': '51',
    'name': 'SUTTER',
    'trinomial_code': 'SUT',
    'report_code': 'SU',
    'ic': 'NEIC'
}, {
    'number': '52',
    'name': 'TEHAMA',
    'trinomial_code': 'TEH',
    'report_code': 'TE',
    'ic': 'NEIC'
}, {
    'number': '53',
    'name': 'TRINITY',
    'trinomial_code': 'TRI',
    'report_code': 'TR',
    'ic': 'NEIC'
}, {
    'number': '54',
    'name': 'TULARE',
    'trinomial_code': 'TUL',
    'report_code': 'TU',
    'ic': 'SSJVIC'
}, {
    'number': '55',
    'name': 'TUOLUMNE',
    'trinomial_code': 'TUO',
    'report_code': 'TO',
    'ic': 'CCaIC'
}, {
    'number': '56',
    'name': 'VENTURA',
    'trinomial_code': 'VEN',
    'report_code': 'VN',
    'ic': 'SCCIC'
}, {
    'number': '57',
    'name': 'YOLO',
    'trinomial_code': 'YOL',
    'report_code': 'YO',
    'ic': 'NWIC'
}, {
    'number': '58',
    'name': 'YUBA',
    'trinomial_code': 'YUB',
    'report_code': 'YU',
    'ic': 'NCIC'
}]


def convert_county_identifier(input_type, input_id, return_type):
    """Looks up a county identifier and returns a different identifier format.

    :param input_type: Type of identifier being searched.
    :param input_id: Identifier to search
    :param return_type: Type of identifier that will be returned.
    :return: Returns the county's identifier in the format requested by the return type parameter.
    """
    input_type = input_type.lower()
    input_id = input_id.upper()
    return_type = return_type.lower()

    if type(input_id) is int:
        input_id = str(input_id).zfill(2)
    valid_input_types = ('number', 'name', 'trinomial_code', 'report_code')
    valid_return_types = ('number', 'name', 'trinomial_code', 'report_code', 'ic', "all")
    if input_type in valid_input_types and return_type in valid_return_types:
        try:
            if return_type == "all":
                return (county for county in county_listing if
                        county[input_type] == input_id).next()
            else:
                return (county[return_type] for county in county_listing if
                        county[input_type] == input_id).next()
        except StopIteration:
            raise StopIteration("Sorry {} was not found under the {} input type.".format(input_id, input_type))
    else:
        raise ValueError('Your input was "{}" and your return type was "{}". They can only be one of the following: \n'
                         '    "Number" - For primary number code (ex. 04)\n'
                         '    "Name" - For the full name of a county\n'
                         '    "Trinomial_Code" - For the three letter county code (ex. BUT)\n'
                         '    "Report_Code" - For the two letter county code (ex. BT)\n'
                         'Additionally your return type could be:\n'
                         '    "IC" -  Returns the information center to which that county is curated by\n'
                         '    "All" - Returns all of the county information as dictionary object\n'
                         '*Not case sensitive'.format(input_type,
                                                                                                         return_type))


def get_ic_county_list(ic, return_type):
    """Looks up identifiers for the counties that an information center covers.

    :param ic: The abbreviation of the Information Center's name (ex. NEIC)
    :param return_type: The type of identifier that will be returned
    :return: Returns a list containing identifiers for all counties that the information center covers.
    """
    ic = ic.upper()
    return_type = return_type.lower()
    # TODO: Because the name and number of IC are potentially mutable. Valid IC's should be pulled from a settings file.
    valid_ics = ('NWIC', 'NEIC', 'NCIC', 'CCAIC', 'CCOIC', 'SSJVIC', 'EIC', 'SCCIC', 'SCIC')
    valid_return_types = ('number', 'name', 'trinomial_code', 'report_code', "all")
    if return_type in valid_return_types:
        if ic in valid_ics and return_type == 'all':
            return [county for county in county_listing if county['ic'] == ic]
        elif ic in valid_ics:
            return [county[return_type] for county in county_listing if county['ic'] == ic]
        else:
            raise ValueError(
                'Sorry, {} is not a valid Information Center Abbreviation. Please use one of the following:\n{}'.format(
                    ic, str(valid_ics)))
    else:
        raise ValueError('Your return type was "{}". It can only be one of the following: \n'
                         '    "Number" - For primary number codes (ex. 04)\n'
                         '    "Name" - For the full names of each county\n'
                         '    "Trinomial_Code" - For the three letter county codes (ex. BUT)\n'
                         '    "Report_Code" - For the two letter county codes (ex. BT)\n'
                         '    "All" - Returns all of the county information as dictionary objects\n'
                         '*Not case sensitive'.format(return_type))
